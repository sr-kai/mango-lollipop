<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SignalStack - Lifecycle Messaging Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .stage-badge { display: inline-block; padding: 2px 8px; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; }
    .tag-pill { display: inline-block; padding: 1px 6px; border-radius: 9999px; font-size: 0.7rem; background: #e5e7eb; color: #374151; cursor: pointer; margin: 1px; }
    .tag-pill.active { background: #3b82f6; color: white; }
    .filter-item { display: flex; justify-content: space-between; align-items: center; padding: 3px 6px; border-radius: 6px; cursor: pointer; font-size: 0.875rem; }
    .filter-item:hover { background: #f3f4f6; }
    .filter-item.active { background: #dbeafe; }
    .collapse-btn { cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: space-between; width: 100%; }
    .collapse-btn .arrow { transition: transform 0.15s; font-size: 0.7rem; color: #9ca3af; }
    .collapse-btn .arrow.open { transform: rotate(90deg); }
    .collapse-body { overflow: hidden; }
    .collapse-body.collapsed { display: none; }
    .msg-row { cursor: pointer; }
    .msg-row:hover { background: #f9fafb; }
    .msg-detail { display: none; }
    .msg-detail.open { display: table-row; }
    .sortable { cursor: pointer; user-select: none; }
    .sortable:hover { color: #3b82f6; }
    .sortable::after { content: ' \2195'; font-size: 0.7em; opacity: 0.4; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">

  <!-- Inline data -->
  <script id="msg-data" type="application/json">[{"id":"TX-01","stage":"TX","name":"Verify Your Email","classification":"transactional","trigger":{"event":"user.signed_up","type":"event"},"wait":"P0D","guards":[],"suppressions":[],"channel":"email","cta":{"text":"Verify email","url":"/verify?token={{token}}"},"segment":"All new signups","tags":["type:transactional"],"format":"plain","from":"SignalStack Team","goal":"Email verification","comments":"Instant. Verification link with 24h expiry.","origin":"new"},{"id":"TX-02","stage":"TX","name":"Password Reset","classification":"transactional","trigger":{"event":"user.password_reset_requested","type":"event"},"wait":"P0D","guards":[],"suppressions":[],"channel":"email","cta":{"text":"Reset password","url":"/reset-password?token={{token}}"},"segment":"Users requesting reset","tags":["type:transactional"],"format":"plain","from":"SignalStack Team","goal":"Password reset","comments":"Instant. Reset link with 1h expiry.","origin":"new"},{"id":"TX-03","stage":"TX","name":"Payment Receipt","classification":"transactional","trigger":{"event":"subscription.payment_processed","type":"event"},"wait":"P0D","guards":[],"suppressions":[],"channel":"email","cta":{"text":"View invoice","url":"/settings/billing"},"segment":"Paying users","tags":["type:transactional"],"format":"plain","from":"SignalStack Team","goal":"Payment confirmation","comments":"Include amount, plan name, next billing date.","origin":"new"},{"id":"TX-04","stage":"TX","name":"Plan Change Confirmation","classification":"transactional","trigger":{"event":"subscription.changed","type":"event"},"wait":"P0D","guards":[],"suppressions":[],"channel":"email","cta":{"text":"View your plan","url":"/settings/billing"},"segment":"Users changing plans","tags":["type:transactional"],"format":"plain","from":"SignalStack Team","goal":"Plan change confirmation","comments":"Show old plan → new plan, new credit allocation, effective date.","origin":"new"},{"id":"TX-05","stage":"TX","name":"Account Deletion Confirmation","classification":"transactional","trigger":{"event":"user.deletion_requested","type":"event"},"wait":"P0D","guards":[],"suppressions":[],"channel":"email","cta":{"text":"Cancel deletion","url":"/settings/account?cancel_deletion=true"},"segment":"Users requesting deletion","tags":["type:transactional"],"format":"plain","from":"SignalStack Team","goal":"Confirm deletion, offer reversal window","comments":"30-day grace period. Show what data will be lost.","origin":"new"},{"id":"AQ-01","stage":"AQ","name":"SignalStack is *not* for everyone","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"PT5M","guards":[],"suppressions":[],"channel":"email","cta":{"text":"Run your first AI search","url":"/app/search"},"segment":"All verified users","tags":["type:educational"],"format":"plain","from":"Vlad from SignalStack","goal":"Onboarding start — drive first search","comments":"Bold, direct welcome email. Make it clear what SignalStack does (and doesn't do). Set expectations for the onboarding sequence. Single CTA to first search.","origin":"new"},{"id":"AQ-02","stage":"AQ","name":"SignalStack is *not* for everyone","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"PT5M","guards":[],"suppressions":[],"channel":"in-app","cta":{"text":"Run your first AI search","url":"/app/search"},"segment":"All verified users","tags":["type:educational"],"format":"plain","from":"Vlad from SignalStack","goal":"Onboarding start — drive first search","comments":"In-app welcome banner. Short, punchy, drive to first search.","origin":"new"},{"id":"AQ-03","stage":"AQ","name":"Your first leads are 3 steps away (1/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P1D","guards":[{"condition":"User has not completed onboarding","expression":"onboarding.completed == false"}],"suppressions":[{"condition":"User already performed a search","expression":"feature.ai_search_used == true"}],"channel":"email","cta":{"text":"Start your first search","url":"/app/search"},"segment":"Verified users who haven't searched yet","tags":["type:educational"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive first meaningful action — AI search","comments":"Getting started guide. Numbered sequence (1/6) sets expectations. Walk through: define ICP → run AI search → see results. Keep it under 150 words.","origin":"new"},{"id":"AC-01","stage":"AC","name":"Find your perfect leads with AI search (2/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P2D","guards":[{"condition":"User has not cancelled","expression":"user.plan != 'cancelled'"}],"suppressions":[{"condition":"User already used AI search","expression":"feature.ai_search_used == true"}],"channel":"email","cta":{"text":"Try AI search","url":"/app/search"},"segment":"Active users","tags":["type:educational","feature:ai-search"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive first use of AI ICP targeting & search","comments":"Show how AI search finds leads matching their ICP. One specific use case. Suppress if already used.","origin":"new"},{"id":"AC-02","stage":"AC","name":"Find your perfect leads with AI search (2/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P2D","guards":[{"condition":"User has not cancelled","expression":"user.plan != 'cancelled'"}],"suppressions":[{"condition":"User already used AI search","expression":"feature.ai_search_used == true"}],"channel":"in-app","cta":{"text":"Try AI search","url":"/app/search"},"segment":"Active users","tags":["type:educational","feature:ai-search"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive first use of AI ICP targeting & search","comments":"In-app nudge to try AI search. Contextual, short.","origin":"new"},{"id":"AC-03","stage":"AC","name":"See the emails behind the companies (3/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P3D","guards":[{"condition":"User has not cancelled","expression":"user.plan != 'cancelled'"}],"suppressions":[{"condition":"User already exported a contact","expression":"feature.contact_exported == true"}],"channel":"email","cta":{"text":"Reveal your first contacts","url":"/app/search"},"segment":"Active users","tags":["type:educational","feature:contact-export"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive first contact reveal & export — THIS IS THE AHA MOMENT","comments":"This is the money email. Seeing verified emails for target companies is the aha moment. Make it tangible.","origin":"new"},{"id":"AC-04","stage":"AC","name":"See the emails behind the companies (3/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P3D","guards":[{"condition":"User has not cancelled","expression":"user.plan != 'cancelled'"}],"suppressions":[{"condition":"User already exported a contact","expression":"feature.contact_exported == true"}],"channel":"in-app","cta":{"text":"Reveal your first contacts","url":"/app/search"},"segment":"Active users","tags":["type:educational","feature:contact-export"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive first contact reveal & export — AHA MOMENT","comments":"In-app nudge to reveal contacts. Contextual prompt when viewing company results.","origin":"new"},{"id":"AC-05","stage":"AC","name":"Know who's ready to buy right now (4/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P5D","guards":[{"condition":"User has not cancelled","expression":"user.plan != 'cancelled'"}],"suppressions":[{"condition":"User already used buyer intent","expression":"feature.buyer_intent_used == true"}],"channel":"email","cta":{"text":"See who's searching for you","url":"/app/buyer-intent"},"segment":"Active users","tags":["type:educational","feature:buyer-intent"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive first use of buyer intent signals","comments":"Buyer intent across 7,500 topics. Frame it as: stop cold outreach, start warm outreach.","origin":"new"},{"id":"AC-06","stage":"AC","name":"Spy on their tech stack (5/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P7D","guards":[{"condition":"User has not cancelled","expression":"user.plan != 'cancelled'"}],"suppressions":[{"condition":"User already used technographics","expression":"feature.technographics_used == true"}],"channel":"email","cta":{"text":"Filter by tech stack","url":"/app/search?filter=technographics"},"segment":"Active users","tags":["type:educational","feature:technographics"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive first use of technographic profiling","comments":"Show how to find companies using specific technologies. Great for competitive displacement plays.","origin":"new"},{"id":"AC-07","stage":"AC","name":"Spy on their tech stack (5/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P7D","guards":[{"condition":"User has not cancelled","expression":"user.plan != 'cancelled'"}],"suppressions":[{"condition":"User already used technographics","expression":"feature.technographics_used == true"}],"channel":"in-app","cta":{"text":"Filter by tech stack","url":"/app/search?filter=technographics"},"segment":"Active users","tags":["type:educational","feature:technographics"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive first use of technographic profiling","comments":"In-app nudge to try tech stack filter. Show when user is in search view.","origin":"new"},{"id":"AC-08","stage":"AC","name":"Find companies with fresh funding (5.5/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P10D","guards":[{"condition":"User has not cancelled","expression":"user.plan != 'cancelled'"}],"suppressions":[{"condition":"User already used funding insights","expression":"feature.funding_insights_used == true"}],"channel":"email","cta":{"text":"Find funded companies","url":"/app/search?filter=funding"},"segment":"Active users","tags":["type:educational","feature:funding-insights"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive first use of funding insights","comments":"Companies that just raised money are actively hiring, buying tools, and expanding. Frame funding data as a timing signal.","origin":"new"},{"id":"AC-09","stage":"AC","name":"Push leads straight to your CRM (6/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P14D","guards":[{"condition":"User has not cancelled","expression":"user.plan != 'cancelled'"}],"suppressions":[{"condition":"User already connected a CRM","expression":"feature.crm_integration_connected == true"}],"channel":"email","cta":{"text":"Connect your CRM","url":"/app/integrations"},"segment":"Active users","tags":["type:educational","feature:crm-integration"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive CRM integration (Pipedrive, HubSpot, Lemlist)","comments":"Final onboarding step. Complete the workflow: find leads → reveal contacts → push to CRM → start outreach.","origin":"new"},{"id":"AC-10","stage":"AC","name":"Push leads straight to your CRM (6/6)","classification":"lifecycle","trigger":{"event":"user.email_verified","type":"event"},"wait":"P14D","guards":[{"condition":"User has not cancelled","expression":"user.plan != 'cancelled'"}],"suppressions":[{"condition":"User already connected a CRM","expression":"feature.crm_integration_connected == true"}],"channel":"in-app","cta":{"text":"Connect your CRM","url":"/app/integrations"},"segment":"Active users","tags":["type:educational","feature:crm-integration"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive CRM integration (Pipedrive, HubSpot, Lemlist)","comments":"In-app prompt to connect CRM. Show in integrations area or after an export.","origin":"new"},{"id":"RV-01","stage":"RV","name":"Your credits are running low","classification":"lifecycle","trigger":{"event":"credits.running_low","type":"event"},"wait":"P0D","guards":[{"condition":"User is on free or basic plan","expression":"user.plan in ['free', 'basic']"}],"suppressions":[],"channel":"email","cta":{"text":"Upgrade for more credits","url":"/pricing"},"segment":"Free and Basic users approaching credit limit","tags":["type:promotional","segment:active"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive upgrade via natural usage growth","comments":"Strongest upgrade signal. Show credits used vs remaining. Frame upgrade as unlocking momentum.","origin":"new"},{"id":"RV-02","stage":"RV","name":"Your credits are running low","classification":"lifecycle","trigger":{"event":"credits.running_low","type":"event"},"wait":"P0D","guards":[{"condition":"User is on free or basic plan","expression":"user.plan in ['free', 'basic']"}],"suppressions":[],"channel":"in-app","cta":{"text":"Upgrade for more credits","url":"/pricing"},"segment":"Free and Basic users approaching credit limit","tags":["type:promotional","segment:active"],"format":"plain","from":"Vlad from SignalStack","goal":"Drive upgrade via natural usage growth","comments":"In-app banner when credits are low. Show remaining count and upgrade CTA.","origin":"new"},{"id":"RV-03","stage":"RV","name":"You've used all your credits","classification":"lifecycle","trigger":{"event":"credits.exhausted","type":"event"},"wait":"P0D","guards":[{"condition":"User has not upgraded","expression":"user.plan != 'business'"}],"suppressions":[],"channel":"email","cta":{"text":"Upgrade now","url":"/pricing"},"segment":"Users who exhausted credits","tags":["type:promotional","priority:high"],"format":"plain","from":"Vlad from SignalStack","goal":"Convert credit-exhausted users to paid","comments":"Be direct: momentum shouldn't stop because of a credit limit. Show what the next tier unlocks.","origin":"new"},{"id":"RV-04","stage":"RV","name":"You've used all your credits","classification":"lifecycle","trigger":{"event":"credits.exhausted","type":"event"},"wait":"P0D","guards":[{"condition":"User has not upgraded","expression":"user.plan != 'business'"}],"suppressions":[],"channel":"in-app","cta":{"text":"Upgrade now","url":"/pricing"},"segment":"Users who exhausted credits","tags":["type:promotional","priority:high"],"format":"plain","from":"Vlad from SignalStack","goal":"Convert credit-exhausted users to paid","comments":"In-app blocker when credits hit zero. Show usage stats and upgrade options.","origin":"new"},{"id":"RV-05","stage":"RV","name":"Your trial ends in {{days_left}} days","classification":"lifecycle","trigger":{"event":"trial.ending_soon","type":"event"},"wait":"P0D","guards":[{"condition":"User is on trial","expression":"user.plan == 'trial'"}],"suppressions":[],"channel":"email","cta":{"text":"Choose a plan","url":"/pricing"},"segment":"Trial users, 3 days before expiry","tags":["type:promotional","segment:trial"],"format":"plain","from":"Vlad from SignalStack","goal":"Convert trial to paid","comments":"Show usage stats. Make them feel the loss of stopping. Reassure data is safe.","origin":"new"},{"id":"RV-06","stage":"RV","name":"Your trial ends in {{days_left}} days","classification":"lifecycle","trigger":{"event":"trial.ending_soon","type":"event"},"wait":"P0D","guards":[{"condition":"User is on trial","expression":"user.plan == 'trial'"}],"suppressions":[],"channel":"in-app","cta":{"text":"Choose a plan","url":"/pricing"},"segment":"Trial users, 3 days before expiry","tags":["type:promotional","segment:trial"],"format":"plain","from":"Vlad from SignalStack","goal":"Convert trial to paid","comments":"In-app banner showing trial countdown and usage stats.","origin":"new"},{"id":"RV-07","stage":"RV","name":"Your trial expired — here's what you keep","classification":"lifecycle","trigger":{"event":"trial.expired","type":"event"},"wait":"P0D","guards":[{"condition":"User has not upgraded","expression":"user.plan != 'basic' && user.plan != 'business'"}],"suppressions":[],"channel":"email","cta":{"text":"Choose a plan","url":"/pricing"},"segment":"Expired trial users","tags":["type:promotional","segment:trial"],"format":"plain","from":"Vlad from SignalStack","goal":"Win back expired trial user","comments":"Reassure data is safe. Remind what they accomplished. Offer Basic at $19/mo as low-friction entry.","origin":"new"},{"id":"RT-01","stage":"RT","name":"Your week in SignalStack","classification":"lifecycle","trigger":{"event":"scheduled","type":"scheduled","schedule":"every friday 9am"},"wait":"P0D","guards":[{"condition":"User was active this week","expression":"user.sessions_this_week >= 1"}],"suppressions":[],"channel":"email","cta":{"text":"Find more leads","url":"/app/search"},"segment":"Active users","tags":["type:behavioral"],"format":"plain","from":"Vlad from SignalStack","goal":"Reinforce value, drive continued usage","comments":"Weekly recap: searches run, contacts revealed, emails found, credits used/remaining.","origin":"new"},{"id":"RT-02","stage":"RT","name":"Your leads are waiting","classification":"lifecycle","trigger":{"event":"user.inactive_3_days","type":"behavioral"},"wait":"P0D","guards":[],"suppressions":[],"channel":"email","cta":{"text":"Jump back in","url":"/app/search"},"segment":"Users inactive 3 days","tags":["type:behavioral","segment:dormant"],"format":"plain","from":"Vlad from SignalStack","goal":"Re-engage before habit breaks","comments":"Soft nudge. Mention new buyer intent data available. Low pressure.","origin":"new"},{"id":"RT-03","stage":"RT","name":"Your leads are waiting","classification":"lifecycle","trigger":{"event":"user.inactive_3_days","type":"behavioral"},"wait":"P0D","guards":[],"suppressions":[],"channel":"in-app","cta":{"text":"Jump back in","url":"/app/search"},"segment":"Users inactive 3 days","tags":["type:behavioral","segment:dormant"],"format":"plain","from":"Vlad from SignalStack","goal":"Re-engage before habit breaks","comments":"In-app notification when user returns after 3 days. Show new matches since last visit.","origin":"new"},{"id":"RT-04","stage":"RT","name":"While you were away, {{prospect_count}} new companies matched your ICP","classification":"lifecycle","trigger":{"event":"user.inactive_7_days","type":"behavioral"},"wait":"P0D","guards":[],"suppressions":[],"channel":"email","cta":{"text":"See new matches","url":"/app/search"},"segment":"Users inactive 7 days","tags":["type:behavioral","segment:dormant"],"format":"plain","from":"Vlad from SignalStack","goal":"Show value they're missing","comments":"Make inactivity feel like missed opportunity. Show what's new in their ICP matches.","origin":"new"},{"id":"RT-05","stage":"RT","name":"Should I close your account?","classification":"lifecycle","trigger":{"event":"user.inactive_14_days","type":"behavioral"},"wait":"P0D","guards":[],"suppressions":[],"channel":"email","cta":{"text":"No, I'm coming back","url":"/app/search"},"segment":"Users inactive 14 days","tags":["type:behavioral","segment:churning","priority:high"],"format":"plain","from":"Vlad from SignalStack","goal":"Last attempt before marking churned","comments":"Breakup email. Bold subject line. Ask what went wrong if they're not coming back.","origin":"new"},{"id":"RF-01","stage":"RF","name":"Your team is missing out","classification":"lifecycle","trigger":{"event":"milestone.first_success","type":"event"},"wait":"P1D","guards":[],"suppressions":[{"condition":"User already invited a teammate","expression":"user.teammates_invited >= 1"}],"channel":"email","cta":{"text":"Invite your team","url":"/app/settings/team"},"segment":"Users who hit first milestone (e.g., 50+ contacts exported)","tags":["type:promotional"],"format":"plain","from":"Vlad from SignalStack","goal":"Organic growth via team invites","comments":"Trigger after first export milestone. Frame as: imagine what your whole team could find.","origin":"new"},{"id":"RF-02","stage":"RF","name":"Your team is missing out","classification":"lifecycle","trigger":{"event":"milestone.first_success","type":"event"},"wait":"P1D","guards":[],"suppressions":[{"condition":"User already invited a teammate","expression":"user.teammates_invited >= 1"}],"channel":"in-app","cta":{"text":"Invite your team","url":"/app/settings/team"},"segment":"Users who hit first milestone (e.g., 50+ contacts exported)","tags":["type:promotional"],"format":"plain","from":"Vlad from SignalStack","goal":"Organic growth via team invites","comments":"In-app prompt after milestone. Show team collaboration benefits.","origin":"new"},{"id":"RF-03","stage":"RF","name":"Know someone who'd love SignalStack?","classification":"lifecycle","trigger":{"event":"user.active_30_days","type":"behavioral"},"wait":"P0D","guards":[],"suppressions":[],"channel":"email","cta":{"text":"Share SignalStack","url":"/app/referral"},"segment":"Power users (30+ days active)","tags":["type:promotional"],"format":"plain","from":"Vlad from SignalStack","goal":"Turn power users into advocates","comments":"Reference the affiliate program. Frame as: help a friend ditch the expensive stuff.","origin":"new"}]</script>
  <script id="analysis-data" type="application/json">{"path":"fresh","company":{"name":"SignalStack","product_type":"AI-powered B2B lead generation","target_audience":"SDRs, small sales teams, and startups building outbound outreach from scratch","key_value_prop":"Find qualified B2B leads 10X faster with AI-driven targeting, 180M+ verified contacts, and buyer intent signals — at a fraction of competitor pricing","aha_moment":"Seeing correct, verified emails for contacts at companies they want to target","key_features":["AI ICP targeting & search","Contact database & email reveal","Buyer intent signals","Technographics profiling","Funding insights","CRM integrations (Pipedrive, HubSpot, Lemlist)"],"pricing_model":"Free tier (50 credits/mo), Basic $19/mo per user (1K credits), Business $89/mo per user (10K credits). No credit card required for signup."},"channels":["email","in-app"],"voice":{"tone":"Direct, personal, genuinely helpful — feels like a smart friend, not a corporation. Conversational but confident. Not afraid to be bold.","formality":2,"emoji_usage":"none","signature_style":"First name only","sample_phrases":["Tough, right!?","I value time and wish neither of us waste it","just in case you need some help","way, way above what our usual customers get","way to go!"],"sender_personas":[{"name":"Vlad","role":"from SignalStack","use_for":["welcome","milestones","feature announcements","tips","onboarding","personal outreach"]},{"name":"SignalStack Team","role":"System","use_for":["transactional","system messages"]}]},"events":{"identity":["user.signed_up","user.email_verified","user.profile_completed","user.invited_teammate"],"activation":["feature.ai_search_used_first_time","feature.contact_exported_first_time","feature.buyer_intent_used_first_time","feature.technographics_used_first_time","feature.funding_insights_used_first_time","feature.crm_integration_connected","onboarding.completed"],"engagement":["search.performed","contact.revealed","contact.exported","list.created","export.csv_downloaded","integration.synced"],"conversion":["trial.started","trial.ending_soon","trial.expired","credits.running_low","credits.exhausted","subscription.created","subscription.upgraded","subscription.downgraded","subscription.cancelled"],"retention":["user.inactive_3_days","user.inactive_7_days","user.inactive_14_days","usage.weekly_summary","credits.monthly_reset","milestone.reached"]},"tags":{"sources":["organic","referral","partner:pipedrive","partner:hubspot","partner:lemlist"],"plans":["free","basic","business"],"segments":["new","power-user","dormant","churning"],"features":["ai-search","buyer-intent","technographics","funding-insights","crm-integration","contact-export"]},"existing":null,"recommendations":["Use Guided Training pattern for activation — walk users through first search → reveal → export workflow step by step","Suppress feature emails when feature already used (don't nag about what they've discovered)","Add credit-based revenue triggers (credits.running_low, credits.exhausted) alongside trial-based ones — this is a usage-gated product","In-app nudges for activation features at point of use (e.g., prompt buyer intent when viewing a company)","Re-engagement sequence at 3/7/14 days — SDRs who stop prospecting for a week are likely evaluating competitors","Welcome email from Vlad: bold, direct, make it clear SignalStack isn't for everyone (matches the voice samples)"]}</script>

  <!-- Header -->
  <header class="bg-white border-b px-6 py-4 flex items-center justify-between">
    <div>
      <h1 class="text-xl font-bold">SignalStack &mdash; Lifecycle Messaging Dashboard</h1>
      <p class="text-sm text-gray-500">AI-powered B2B lead generation &bull; 33 messages &bull; 5 transactional, 28 lifecycle</p>
    </div>
    <div class="flex gap-2">
      <button id="btn-all" class="px-3 py-1 text-sm rounded border border-gray-300 bg-white hover:bg-gray-100" onclick="setView('all')">All</button>
      <button id="btn-tx" class="px-3 py-1 text-sm rounded border border-gray-300 bg-white hover:bg-gray-100" onclick="setView('tx')">Transactional</button>
      <button id="btn-lc" class="px-3 py-1 text-sm rounded border border-gray-300 bg-white hover:bg-gray-100" onclick="setView('lc')">Lifecycle</button>
    </div>
  </header>

  <div class="flex">
    <!-- Sidebar: Filters -->
    <aside class="w-56 bg-white border-r p-4 min-h-screen space-y-1">

      <!-- Stage filter -->
      <div>
        <button class="collapse-btn" onclick="toggleCollapse('stage-filter')">
          <span class="text-sm font-semibold text-gray-500 uppercase">Stage</span>
          <span class="arrow open" id="arrow-stage-filter">&#9654;</span>
        </button>
        <div id="stage-filter" class="collapse-body mt-1 space-y-0.5">
          <div class="filter-item" data-stage="TX" onclick="toggleStage(this)"><span class="stage-badge" style="background:#f0f0f0;color:#666">Transactional</span><span class="text-xs text-gray-400">5</span></div>
          <div class="filter-item" data-stage="AQ" onclick="toggleStage(this)"><span class="stage-badge" style="background:#d4edda;color:#28a745">Acquisition</span><span class="text-xs text-gray-400">3</span></div>
          <div class="filter-item" data-stage="AC" onclick="toggleStage(this)"><span class="stage-badge" style="background:#cce5ff;color:#007bff">Activation</span><span class="text-xs text-gray-400">10</span></div>
          <div class="filter-item" data-stage="RV" onclick="toggleStage(this)"><span class="stage-badge" style="background:#fff3cd;color:#ffc107">Revenue</span><span class="text-xs text-gray-400">7</span></div>
          <div class="filter-item" data-stage="RT" onclick="toggleStage(this)"><span class="stage-badge" style="background:#ffe5cc;color:#fd7e14">Retention</span><span class="text-xs text-gray-400">5</span></div>
          <div class="filter-item" data-stage="RF" onclick="toggleStage(this)"><span class="stage-badge" style="background:#e8d5f5;color:#6f42c1">Referral</span><span class="text-xs text-gray-400">3</span></div>
        </div>
      </div>

      <!-- Channel filter -->
      <div>
        <button class="collapse-btn" onclick="toggleCollapse('channel-filter')">
          <span class="text-sm font-semibold text-gray-500 uppercase">Channel</span>
          <span class="arrow open" id="arrow-channel-filter">&#9654;</span>
        </button>
        <div id="channel-filter" class="collapse-body mt-1 space-y-0.5">
          <div class="filter-item" data-channel="email" onclick="toggleChannel(this)"><span>email</span><span class="text-xs text-gray-400">23</span></div>
          <div class="filter-item" data-channel="in-app" onclick="toggleChannel(this)"><span>in-app</span><span class="text-xs text-gray-400">10</span></div>
        </div>
      </div>

      <!-- Tag filter -->
      <div>
        <button class="collapse-btn" onclick="toggleCollapse('tag-filter')">
          <span class="text-sm font-semibold text-gray-500 uppercase">Tags</span>
          <span class="arrow open" id="arrow-tag-filter">&#9654;</span>
        </button>
        <div id="tag-filter" class="collapse-body mt-1">
          <span class="tag-pill" data-tag="feature:ai-search" onclick="toggleTag(this)">feature:ai-search <span class="text-gray-400">(2)</span></span>
          <span class="tag-pill" data-tag="feature:buyer-intent" onclick="toggleTag(this)">feature:buyer-intent <span class="text-gray-400">(1)</span></span>
          <span class="tag-pill" data-tag="feature:contact-export" onclick="toggleTag(this)">feature:contact-export <span class="text-gray-400">(2)</span></span>
          <span class="tag-pill" data-tag="feature:crm-integration" onclick="toggleTag(this)">feature:crm-integration <span class="text-gray-400">(2)</span></span>
          <span class="tag-pill" data-tag="feature:funding-insights" onclick="toggleTag(this)">feature:funding-insights <span class="text-gray-400">(1)</span></span>
          <span class="tag-pill" data-tag="feature:technographics" onclick="toggleTag(this)">feature:technographics <span class="text-gray-400">(2)</span></span>
          <span class="tag-pill" data-tag="priority:high" onclick="toggleTag(this)">priority:high <span class="text-gray-400">(3)</span></span>
          <span class="tag-pill" data-tag="segment:active" onclick="toggleTag(this)">segment:active <span class="text-gray-400">(2)</span></span>
          <span class="tag-pill" data-tag="segment:churning" onclick="toggleTag(this)">segment:churning <span class="text-gray-400">(1)</span></span>
          <span class="tag-pill" data-tag="segment:dormant" onclick="toggleTag(this)">segment:dormant <span class="text-gray-400">(3)</span></span>
          <span class="tag-pill" data-tag="segment:trial" onclick="toggleTag(this)">segment:trial <span class="text-gray-400">(3)</span></span>
          <span class="tag-pill" data-tag="type:behavioral" onclick="toggleTag(this)">type:behavioral <span class="text-gray-400">(5)</span></span>
          <span class="tag-pill" data-tag="type:educational" onclick="toggleTag(this)">type:educational <span class="text-gray-400">(13)</span></span>
          <span class="tag-pill" data-tag="type:promotional" onclick="toggleTag(this)">type:promotional <span class="text-gray-400">(10)</span></span>
          <span class="tag-pill" data-tag="type:transactional" onclick="toggleTag(this)">type:transactional <span class="text-gray-400">(5)</span></span>
        </div>
      </div>

      <button class="mt-2 text-xs text-blue-500 hover:underline" onclick="clearAllFilters()">Clear all filters</button>
    </aside>

    <!-- Main content -->
    <main class="flex-1 p-6 space-y-8">

      <!-- Matrix Table -->
      <section>
        <h2 class="text-lg font-semibold mb-3">Message Matrix</h2>
        <div class="bg-white rounded-lg border overflow-x-auto">
          <table class="w-full text-sm" id="matrix-table">
            <thead class="bg-gray-50 text-left text-xs text-gray-500 uppercase">
              <tr>
                <th class="px-3 py-2 sortable" data-col="id" onclick="sortTable('id')">ID</th>
                <th class="px-3 py-2 sortable" data-col="stage" onclick="sortTable('stage')">Stage</th>
                <th class="px-3 py-2 sortable" data-col="name" onclick="sortTable('name')">Name</th>
                <th class="px-3 py-2">Trigger</th>
                <th class="px-3 py-2 sortable" data-col="wait" onclick="sortTable('wait')">Wait</th>
                <th class="px-3 py-2">Channel</th>
                <th class="px-3 py-2">CTA</th>
                <th class="px-3 py-2">Tags</th>
              </tr>
            </thead>
            <tbody id="matrix-body">
            </tbody>
          </table>
        </div>
      </section>

    </main>
  </div>

  <script>
    const allMessages = JSON.parse(document.getElementById('msg-data').textContent);
    let currentView = 'all';
    let activeStages = new Set();
    let activeChannels = new Set();
    let activeTags = new Set();
    let sortCol = 'id';
    let sortAsc = true;

    const stageMeta = {"TX":{"label":"Transactional","color":"#666","bg":"#f0f0f0"},"AQ":{"label":"Acquisition","color":"#28a745","bg":"#d4edda"},"AC":{"label":"Activation","color":"#007bff","bg":"#cce5ff"},"RV":{"label":"Revenue","color":"#ffc107","bg":"#fff3cd"},"RT":{"label":"Retention","color":"#fd7e14","bg":"#ffe5cc"},"RF":{"label":"Referral","color":"#6f42c1","bg":"#e8d5f5"}};

    // --- Collapse ---
    function toggleCollapse(id) {
      const body = document.getElementById(id);
      const arrow = document.getElementById('arrow-' + id);
      body.classList.toggle('collapsed');
      arrow.classList.toggle('open');
    }

    // --- View toggle ---
    function setView(view) {
      currentView = view;
      document.getElementById('btn-all').classList.toggle('bg-blue-100', view === 'all');
      document.getElementById('btn-tx').classList.toggle('bg-blue-100', view === 'tx');
      document.getElementById('btn-lc').classList.toggle('bg-blue-100', view === 'lc');
      render();
    }

    // --- Stage filter ---
    function toggleStage(el) {
      const stage = el.dataset.stage;
      if (activeStages.has(stage)) { activeStages.delete(stage); el.classList.remove('active'); }
      else { activeStages.add(stage); el.classList.add('active'); }
      render();
    }

    // --- Channel filter ---
    function toggleChannel(el) {
      const ch = el.dataset.channel;
      if (activeChannels.has(ch)) { activeChannels.delete(ch); el.classList.remove('active'); }
      else { activeChannels.add(ch); el.classList.add('active'); }
      render();
    }

    // --- Tag filter ---
    function toggleTag(el) {
      const tag = el.dataset.tag;
      if (activeTags.has(tag)) { activeTags.delete(tag); el.classList.remove('active'); }
      else { activeTags.add(tag); el.classList.add('active'); }
      render();
    }

    function clearAllFilters() {
      activeStages.clear();
      activeChannels.clear();
      activeTags.clear();
      document.querySelectorAll('.filter-item.active, .tag-pill.active').forEach(el => el.classList.remove('active'));
      currentView = 'all';
      document.getElementById('btn-all').classList.add('bg-blue-100');
      document.getElementById('btn-tx').classList.remove('bg-blue-100');
      document.getElementById('btn-lc').classList.remove('bg-blue-100');
      render();
    }

    function sortTable(col) {
      if (sortCol === col) sortAsc = !sortAsc;
      else { sortCol = col; sortAsc = true; }
      render();
    }

    function esc(s) {
      const d = document.createElement('div');
      d.textContent = s;
      return d.innerHTML;
    }

    function getMsgChannel(m) {
      return m.channel || (m.channels && m.channels[0]) || '';
    }

    function render() {
      let msgs = allMessages;

      // View filter
      if (currentView === 'tx') msgs = msgs.filter(m => m.classification === 'transactional');
      if (currentView === 'lc') msgs = msgs.filter(m => m.classification === 'lifecycle');

      // Stage filter (OR within stages)
      if (activeStages.size > 0) msgs = msgs.filter(m => activeStages.has(m.stage));

      // Channel filter (OR within channels)
      if (activeChannels.size > 0) msgs = msgs.filter(m => activeChannels.has(getMsgChannel(m)));

      // Tag filter (OR within tags)
      if (activeTags.size > 0) msgs = msgs.filter(m => m.tags.some(t => activeTags.has(t)));

      msgs.sort((a, b) => {
        let va = a[sortCol] ?? '';
        let vb = b[sortCol] ?? '';
        if (typeof va === 'string') va = va.toLowerCase();
        if (typeof vb === 'string') vb = vb.toLowerCase();
        if (va < vb) return sortAsc ? -1 : 1;
        if (va > vb) return sortAsc ? 1 : -1;
        return 0;
      });

      const tbody = document.getElementById('matrix-body');
      tbody.innerHTML = '';
      for (const m of msgs) {
        const meta = stageMeta[m.stage] || { label: m.stage, color: '#666', bg: '#f0f0f0' };
        const ch = getMsgChannel(m);
        const tr = document.createElement('tr');
        tr.className = 'msg-row border-t';
        tr.innerHTML =
          '<td class="px-3 py-2 font-mono text-xs">' + esc(m.id) + '</td>' +
          '<td class="px-3 py-2"><span class="stage-badge" style="background:' + meta.bg + ';color:' + meta.color + '">' + esc(meta.label) + '</span></td>' +
          '<td class="px-3 py-2 font-medium">' + esc(m.name) + '</td>' +
          '<td class="px-3 py-2 text-xs text-gray-600">' + esc(m.trigger.event) + '</td>' +
          '<td class="px-3 py-2 font-mono text-xs">' + esc(m.wait) + '</td>' +
          '<td class="px-3 py-2 text-xs">' + esc(ch) + '</td>' +
          '<td class="px-3 py-2 text-xs">' + esc(m.cta.text) + '</td>' +
          '<td class="px-3 py-2">' + m.tags.map(t => '<span class="tag-pill">' + esc(t) + '</span>').join(' ') + '</td>';
        tr.addEventListener('click', () => toggleDetail(m.id));
        tbody.appendChild(tr);

        // Detail row
        const detail = document.createElement('tr');
        detail.id = 'detail-' + m.id;
        detail.className = 'msg-detail bg-gray-50';
        detail.innerHTML =
          '<td colspan="8" class="px-6 py-4 text-sm">' +
          '<div class="grid grid-cols-2 gap-4">' +
          (m.subject ? '<div><strong>Subject:</strong> ' + esc(m.subject) + '</div>' : '') +
          '<div><strong>From:</strong> ' + esc(m.from) + '</div>' +
          '<div><strong>Segment:</strong> ' + esc(m.segment) + '</div>' +
          '<div><strong>Goal:</strong> ' + esc(m.goal) + '</div>' +
          '<div><strong>Format:</strong> ' + esc(m.format) + '</div>' +
          '<div><strong>Guards:</strong> ' + (m.guards.length ? m.guards.map(g => esc(g.condition)).join('; ') : '\u2014') + '</div>' +
          '<div><strong>Suppressions:</strong> ' + (m.suppressions.length ? m.suppressions.map(s => esc(s.condition)).join('; ') : '\u2014') + '</div>' +
          '<div class="col-span-2"><strong>Comments:</strong> ' + esc(m.comments || '') + '</div>' +
          '</div>' +
          (m.body ? '<div class="mt-3"><strong>Body:</strong><pre class="mt-1 p-3 bg-white border rounded text-xs whitespace-pre-wrap">' + esc(m.body) + '</pre></div>' : '') +
          '<div class="mt-3"><a href="messages.html#' + encodeURIComponent(m.id) + '" style="color:#3b82f6;font-size:0.8rem;text-decoration:none" onmouseover="this.style.textDecoration=\'underline\'" onmouseout="this.style.textDecoration=\'none\'">Open full preview &rarr;</a></div>' +
          '</td>';
        tbody.appendChild(detail);
      }
    }

    function toggleDetail(id) {
      const el = document.getElementById('detail-' + id);
      if (el) el.classList.toggle('open');
    }

    // Initial render
    setView('all');
  </script>

  <footer style="text-align:center;padding:16px;font-size:0.75rem;color:#9ca3af;border-top:1px solid #e5e7eb">
    <a href="https://github.com/sr-kai/mango-lollipop" style="color:#6b7280;text-decoration:none;font-weight:600">Mango Lollipop</a> &mdash; AI-powered lifecycle messaging for SaaS<br>
    Made by Sasha Kai with probably too much coffee.
  </footer>
</body>
</html>